<?php
// Charger l'autoloader généré par Composer
require_once '../Aidappart/Utils/vendor/autoload.php';

use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;
use PHPMailer\PHPMailer\SMTP;
require 'Utils/vendor/PHPMailer/src/Exception.php';
require 'Utils/vendor/PHPMailer/src/PHPMailer.php';
require 'Utils/vendor/PHPMailer/src/SMTP.php';

function envoie_mail($nom_to, $mail_to, $subject,$message){
    $mail = new PHPMailer(true);
    try {
        // Configuration du serveur SMTP
        $mail->isSMTP();
        $mail->SMTPDebug=0;
        $mail->SMTPSecure='ssl';
        $mail->Host = 'smtp.gmail.com'; // Serveur SMTP de GMAIL
        $mail->SMTPAuth=true;

        $mail->Username = "felix.blanchier@gmail.com";
        $mail->Password = "hwrjfumzdlaqhezu";
        $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS;
        $mail->Port = 465;

        $mail->setFrom('felix.blanchier@gmail.com', 'felixBlanchier');
        $mail->addAddress($mail_to,$nom_to);
        $mail->isHTML(true);
        $mail->Subject = $subject;
        $mail->Body=$message;
        $mail->setLanguage('fr','/optional/path/to/language/directory/');

        // Envoyer l'e-mail
        $mail->send();
        echo 'E-mail envoyé avec succès !';
    } catch (Exception $e) {
        echo "Erreur lors de l'envoi de l'e-mail : {$mail->ErrorInfo}";
    }
}


if (envoie_mail('felix1', 'gabrielnoame82@gmail.com','test1','qtetstesgsfds33245643')){
    echo 'ok';
}
else {
    echo "erreur";
}